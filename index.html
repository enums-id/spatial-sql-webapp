<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Enums Spatial SQL with DuckDB</title>

  <meta name="description" content="A browser-based SQL and spatial analysis playground powered by DuckDB WASM. Upload data, run SQL, perform GIS operations, visualize results on a map, and export GeoJSON or CSV — all client-side.">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Tailwind CSS -->
  <link rel="stylesheet" href="./src/style.css">
  <link href="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.css" rel="stylesheet" />

  <style>
    html, body {
      height: 100%;
    }

    #editor {
      height: 100%;
    }
  </style>
</head>
<body class="h-full bg-slate-950 text-slate-100">
<div class="flex flex-col h-screen w-screen">
  <div class="p-4 border-b border-slate-800 flex justify-start items-center">
    <img src="https://cdn.simpleicons.org/duckdb/94a3b8" class="h-5 w-5" />
    <h1 class="mx-4 text-xl text-white font-bold">
  Spatial SQL WebApp
  <span class="ml-1 text-sm font-normal text-white/70">
    by 
    
    <a href="https://enums.id" class="underline" target="_blank">
      Enums.id
    </a>
    powered by DuckDB
  </span>

</h1>

</div>
    <div class="flex grow overflow-auto ">
      <!-- Left Panel -->
      <div class="flex w-1/2 flex-col border-r border-slate-800 bg-slate-900">
        <!-- Toolbar -->
        <div class="flex items-center gap-3 border-b border-slate-800 px-4 py-2">
          <button id="executeBtn" class="rounded-md bg-emerald-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-emerald-500">
            ▶ Execute
          </button>
          <label class="cursor-pointer rounded-md bg-slate-800 px-3 py-1.5 text-sm text-slate-200 hover:bg-slate-700">
            Upload file
            <input type="file" id="fileInput" class="hidden" />
          </label>
        </div>

        <!-- Uploaded Files -->
        <div class="border-b border-slate-800 px-4 py-2">
          <h4 class="mb-1 text-xs font-semibold uppercase tracking-wide text-slate-400">Uploaded files</h4>
          <ul id="fileList" class="space-y-1 text-sm text-slate-200">
            <li class="text-slate-500">No files uploaded</li>
          </ul>
        </div>

        <!-- Spatial Helpers -->
        <div class="border-b border-slate-800 px-4 py-2">
          <h4 class="mb-2 text-xs font-semibold uppercase tracking-wide text-slate-400">Spatial helpers</h4>
          <div class="flex flex-wrap gap-2">
            <button data-snippet="read" class="snippet-btn">ST_Read</button>
            <button data-snippet="buffer" class="snippet-btn">Buffer (meters)</button>
            <button data-snippet="area" class="snippet-btn">Area</button>
            <button data-snippet="centroid" class="snippet-btn">Centroid</button>
            <button data-snippet="bbox" class="snippet-btn">BBox</button>
          </div>
        </div>

        <!-- Monaco Editor -->
        <div class="flex-1">
          <div id="editor"></div>
        </div>
      </div>

      <!-- Right Panel -->
      <div class="w-1/2 bg-slate-950 p-6 flex flex-col gap-4 overflow-auto ">
        <div class="flex items-center justify-between">
          <h3 class="text-lg font-semibold">Output</h3>
          <div class="flex gap-2">
            <button id="downloadGeoJSONBtn" class="hidden rounded-md bg-slate-800 px-3 py-1.5 text-sm text-slate-200 hover:bg-slate-700">
              ⬇ Download GeoJSON
            </button>
            <button id="downloadTableBtn" class="hidden rounded-md bg-slate-800 px-3 py-1.5 text-sm text-slate-200 hover:bg-slate-700">
              ⬇ Download Table
            </button>
          </div>
        </div>
        <div id="output" class="flex-1 overflow-auto rounded-md border border-slate-800 bg-slate-900 p-4 text-sm text-slate-200">
          <p class="text-slate-400">Run a query to see results.</p>
        </div>
        <div class="h-64 rounded-md overflow-hidden border border-slate-800" id="map"></div>
      </div>
    </div>

    <footer class="text-xs p-2 text-slate-300 border-t border-slate-800 flex justify-start items-center">
      <span>
        &#169; 2026 Enums.id 
      </span>

      <a href="https://github.com/enums-id/spatial-sql-webapp" target="_blank">
        <span class="mx-4 flex items-center underline">
          <img src="https://cdn.simpleicons.org/github/ffffff" class="h-3 w-3 inline" alt="GitHub"/>
          <span class="px-1">
            Github
          </span>
        </span>

      </a>
    </footer>
</div>

  <!-- Monaco Loader -->
  <script src="https://unpkg.com/monaco-editor@0.45.0/min/vs/loader.js"></script>
  <script src="./src/monaco.js"></script>
  <!-- DuckDB WASM (ESM, isolated from Monaco AMD loader) -->


<script type="module" src="./src/script.js"></script>
</body>
</html>
